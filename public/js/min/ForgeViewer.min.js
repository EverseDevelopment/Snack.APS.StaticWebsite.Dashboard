var viewer,modData={};function launchViewer(r){function a(e){var r=e.getRoot().getDefaultGeometry(!0);viewer.loadDocumentNode(e,r,{skipHiddenFragments:!1}).then(e=>{}),viewer.setDisplayEdges(!1),viewer.setProgressiveRendering(!0),viewer.setGroundReflection(!1),viewer.setGroundShadow(!1),viewer.setQualityLevel(!1,!1),viewer.setGroundReflectionAlpha(0),viewer.hideLines(!0),viewer.setOptimizeNavigation(!0),this.viewer.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,i)}function i(){var e;console.log("Geometry Loaded"),viewer.search("",function(e){viewer.model.getBulkProperties(e,["Category"],function(e){getListCategories(e,function(e){arraySimplify(e,function(e){modData.quantities=e.quantities,modData.Elements=e.Elements,modData.Load="Done",showPowerBIReport()})})})},null,["Comments"]),DashBoardColors=((e=[]).push("rgba(84, 71, 140, 0.8)"),e.push("rgba(44, 105, 154, 0.8)"),e.push("rgba(4, 139, 168, 0.8)"),e.push("rgba(13, 179, 158, 0.8)"),e.push("rgba(22, 219, 147, 0.8)"),e.push("rgba(131, 227, 119, 0.8)"),e.push("rgba(185, 231, 105, 0.8)"),e.push("rgba(239, 234, 90, 0.8)"),e.push("rgba(241, 196, 83, 0.8)"),e.push("rgba(255, 102, 102, 0.8)"),e.push("rgba(219, 0, 182, 0.8)"),e.push("rgba(242, 158, 76, 0.8)"),e.push("rgba(188, 0, 221, 0.8)"),e.push("rgba(219, 0, 182, 0.8)"),e.push("rgba(242, 0, 1, 0.8)"),e.push("rgba(242, 111, 1, 0.8)"),e.push("rgba(242, 180, 15, 0.8)"),e.push("rgba(242, 195, 100, 0.8)"),e.push("rgba(65, 95, 134, 0.8)"),e.push("rgba(25, 145, 158, 0.8)"),e.push("rgba(0, 98, 255, 0.8)"),e.push("rgba(255, 242, 0, 0.8)"),e.push("rgba(255, 0, 123, 0.8)"),e.push("rgba(255, 0, 43, 0.8)"),e.push("rgba(0, 187, 255, 0.8)"),e.push("rgba(0, 187, 255, 0.8)"),e.push("rgba(41, 227, 134, 0.8)"),e.push("rgba(109, 189, 40, 0.8)"),e.push("rgba(39, 159, 245, 0.8)"),{background:e})}function s(e){console.error("onDocumentLoadFailure() - errorCode:"+e)}Autodesk.Viewing.Initializer({env:"AutodeskProduction",getAccessToken:function(r){var e={url:privateVariables.tokenURL,method:"GET",timeout:0,headers:{"x-api-key":privateVariables.apiKey}};$.ajax(e).done(function(e){r(e.access_token,e.expires_in)})}},async()=>{(viewer=new Autodesk.Viewing.GuiViewer3D(document.getElementById("forgeViewer"),{extensions:["ToolBar"]})).start();var e="urn:"+r;Autodesk.Viewing.Document.load(e,a,s)})}launchViewer(privateVariables.urn);